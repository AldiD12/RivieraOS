<!DOCTYPE html>
<html>
<head>
    <title>Test Frontend API</title>
</head>
<body>
    <h1>Test Frontend API Calls</h1>
    <button onclick="testLogin()">Test SuperAdmin Login</button>
    <button onclick="testBusinesses()">Test Businesses (with token)</button>
    <div id="results"></div>

    <script>
        const AZURE_BASE_URL = 'https://blackbear-api.kindhill-9a9eea44.italynorth.azurecontainerapps.io/api';
        let token = null;

        function log(message) {
            const results = document.getElementById('results');
            results.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }

        async function testLogin() {
            log('üîê Testing SuperAdmin login...');
            
            try {
                const response = await fetch(`${AZURE_BASE_URL}/Auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: 'superadmin@rivieraos.com',
                        password: 'RivieraOS2024!'
                    })
                });

                log(`Response status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log('‚úÖ Login successful!');
                    log(`User: ${data.user.fullName} (${data.user.email})`);
                    log(`Role: ${data.user.role}`);
                    log(`Token: ${data.token ? 'Present' : 'Missing'}`);
                    
                    token = data.token;
                } else {
                    log(`‚ùå Login failed: ${response.status} ${response.statusText}`);
                    const errorData = await response.text();
                    log(`Error: ${errorData}`);
                }
            } catch (error) {
                log(`‚ùå Network error: ${error.message}`);
            }
        }

        async function testBusinesses() {
            if (!token) {
                log('‚ùå No token available. Login first.');
                return;
            }

            log('üîÑ Testing businesses endpoint...');
            
            try {
                const response = await fetch(`${AZURE_BASE_URL}/Businesses`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    }
                });

                log(`Response status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ Businesses loaded: ${data.length} found`);
                    data.forEach(business => {
                        log(`- ${business.brandName || business.registeredName} (${business.contactEmail})`);
                    });
                } else {
                    log(`‚ùå Businesses failed: ${response.status} ${response.statusText}`);
                    const errorData = await response.text();
                    log(`Error: ${errorData}`);
                }
            } catch (error) {
                log(`‚ùå Network error: ${error.message}`);
            }
        }
    </script>
</body>
</html>